var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};
$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
function keybind(a){var b={};b.value=a;b.isDown=!1;b.isUp=!0;b.press=void 0;b.release=void 0;b.downHandler=function(a){a.key===b.value&&(b.isUp&&b.press&&b.press(a),b.isDown=!0,b.isUp=!1,a.preventDefault())};b.upHandler=function(a){a.key===b.value&&(b.isDown&&b.release&&b.release(a),b.isDown=!1,b.isUp=!0,a.preventDefault())};var c=b.downHandler.bind(b),d=b.upHandler.bind(b);window.addEventListener("keydown",c,!1);window.addEventListener("keyup",d,!1);b.unsubscribe=function(){window.removeEventListener("keydown",
c);window.removeEventListener("keyup",d)};return b}Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]});Array.prototype.removeFrom||(Array.prototype.removeFrom=function(a){return this.splice(a,1)});function round(a,b){return Math.floor(a/b)*b}function remap(a,b,c){return c[0]+(a-b[0])*(c[1]-c[0])/(b[1]-b[0])}
function isMobile(){var a=!1,b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a}var KEY_TYPES="leftkey blackkey midkey blackkey rightkey leftkey blackkey midkey blackkey midkey blackkey rightkey leftkey blackkey midkey blackkey rightkey leftkey blackkey midkey blackkey midkey blackkey rightkey-logo lastkey".split(" "),BUTTON_TYPE="button-up.png button-up-green.png button-up-yellow.png button-up-blue.png button-down.png button-down-green.png button-down-yellow.png button-down-blue.png".split(" "),SLIDER_RANGE=[21,41];
function frequency(a){return NOTE_TO_FREQ[a]}
var NOTE_TO_FREQ=new Float32Array([8.1757989156,8.661957218,9.1770239974,9.7227182413,10.3008611535,10.9133822323,11.5623257097,12.2498573744,12.9782717994,13.75,14.5676175474,15.4338531643,16.3515978313,17.3239144361,18.3540479948,19.4454364826,20.6017223071,21.8267644646,23.1246514195,24.4997147489,25.9565435987,27.5,29.1352350949,30.8677063285,32.7031956626,34.6478288721,36.7080959897,38.8908729653,41.2034446141,43.6535289291,46.249302839,48.9994294977,51.9130871975,55,58.2704701898,61.735412657,
65.4063913251,69.2956577442,73.4161919794,77.7817459305,82.4068892282,87.3070578583,92.4986056779,97.9988589954,103.826174395,110,116.5409403795,123.470825314,130.8127826503,138.5913154884,146.8323839587,155.563491861,164.8137784564,174.6141157165,184.9972113558,195.9977179909,207.65234879,220,233.081880759,246.9416506281,261.6255653006,277.1826309769,293.6647679174,311.1269837221,329.6275569129,349.228231433,369.9944227116,391.9954359817,415.3046975799,440,466.1637615181,493.8833012561,523.2511306012,
554.3652619537,587.3295358348,622.2539674442,659.2551138257,698.456462866,739.9888454233,783.9908719635,830.6093951599,880,932.3275230362,987.7666025122,1046.5022612024,1108.7305239075,1174.6590716696,1244.5079348883,1318.5102276515,1396.912925732,1479.9776908465,1567.981743927,1661.2187903198,1760,1864.6550460724,1975.5332050245,2093.0045224048,2217.461047815,2349.3181433393,2489.0158697766,2637.020455303,2793.825851464,2959.9553816931,3135.963487854,3322.4375806396,3520,3729.3100921447,3951.066410049,
4186.0090448096,4434.92209563,4698.6362866785,4978.0317395533,5274.0409106059,5587.6517029281,5919.9107633862,6271.926975708,6644.8751612791,7040,7458.6201842894,7902.132820098,8372.0180896192,8869.8441912599,9397.272573357,9956.0634791066,10548.081821211,11175.303405856,11839.821526772,12543.853951416]),brcWindow=function(a){var b=PIXI.NineSlicePlane.call(this,PIXI.Loader.shared.resources.sprites.spritesheet.textures["window.png"],7,7,7,7)||this;a=a||{x:17,y:22};b.width=a.x;b.height=a.y;b.pivot.x=
.5*b.width;b.pivot.y=.5*b.height;var c=new PIXI.NineSlicePlane(PIXI.Loader.shared.resources.sprites.textures["dummy-texture.png"],0,0,0,0);b.xButton=new brcButton("x",void 0,{x:1,y:0},void 0,c,c);b.xButton.position.set(a.x-2,0);b.xButton.onClick=function(){b.visible=!1};b.addChild(b.xButton);b.interactive=!0;return b};$jscomp.inherits(brcWindow,PIXI.NineSlicePlane);
$jscomp.global.Object.defineProperties(brcWindow.prototype,{dimensions:{configurable:!0,enumerable:!0,get:function(){return{x:this.background.width,y:this.background.height}},set:function(a){this.background.width=a.x;this.background.height=a.y}}});
var brcButton=function(a,b,c,d,h,e){function k(a){this.background.visible=!1;this.clicked.visible=!0;--this.foreground.x;this.foreground.y+=1}function l(a){this.background.visible=!0;this.clicked.visible=!1;this.foreground.x+=1;--this.foreground.y;this.onClick();this.isToggle&&(this.onOff=!this.onOff,this.foreground.tint=this.onOff?10547314:16777215,this.onToggle(this.onOff))}function g(){this.background.visible=!0;this.clicked.visible=!1;this.foreground.x+=1;--this.foreground.y}var f=PIXI.Container.call(this)||
this;c=c||{x:0,y:0};a=a||"";var m=new PIXI.BitmapText(a,{font:"8px pixelmix",align:"center"});f.text=a;f.foreground=m;a=h||new PIXI.NineSlicePlane(PIXI.Loader.shared.resources.sprites.spritesheet.textures["button.png"],3,3,3,3);b=b||{x:m.width+7,y:m.height+7};a.width=b.x;a.height=b.y;f.foreground.pivot.set(m.width/2,m.height/2);f.foreground.position.set(a.width/2,a.height/2-2);f.background=a;e=e||new PIXI.NineSlicePlane(PIXI.Loader.shared.resources.sprites.spritesheet.textures["button-clicked.png"],
3,3,3,3);e.width=b.x;e.height=b.y;e.visible=!1;f.clicked=e;f.addChild(f.background);f.addChild(f.clicked);f.addChild(f.foreground);f.pivot.x=a.width*c.x;f.pivot.y=a.height*c.y;f.onClick=function(){};f.interactive=!0;f.buttonMode=!0;f.on("mousedown",k).on("touchstart",k).on("mouseup",l).on("mouseupoutside",g).on("touchend",l).on("touchendoutside",g);void 0!=d&&(f.tooltip=d,f.on("mouseover",TooltipSet.showTooltip).on("mouseout",TooltipSet.hideTooltip));f.isToggle=!1;f.onOff=!1;return f};
$jscomp.inherits(brcButton,PIXI.Container);$jscomp.global.Object.defineProperties(brcButton.prototype,{face:{configurable:!0,enumerable:!0,set:function(a){this.removeChild(this.foreground);this.addChild(a);this.foreground=a}}});var TooltipSet=function(){return PIXI.Container.call(this)||this};$jscomp.inherits(TooltipSet,PIXI.Container);
TooltipSet.prototype.create=function(a,b,c){b=b||"left";""==a&&(a="placeholder");void 0==c&&(c={x:0,y:1},"right"==b&&(c.x=1));var d=new PIXI.Container;d.text=a;a=new PIXI.BitmapText(a,{font:"8px pixelmix",align:b});b=new PIXI.NineSlicePlane(PIXI.Loader.shared.resources.sprites.spritesheet.textures["tooltip.png"],4,4,4,4);b.height=13;b.width=a.width+8;a.x+=4;a.y+=2;d.set=this;d.addChild(b);d.addChild(a);d.primaryAnchor=c;d.pivot.x=d.width*c.x;d.pivot.y=d.height*c.y;d.visible=!1;d.cacheAsBitmap=!0;
this.addChild(d);return d};TooltipSet.showTooltipOnHover=function(a){this.tooltip.visible=!0;this.tooltip.position=this.position};TooltipSet.showTooltipOnTap=function(a){var b=this;this.tooltip.parent.visible&&(this.tooltip.set.previous&&(this.tooltip.set.previous.visible=!1),this.tooltip.pivot.x=0,this.tooltip.pivot.y=0,this.tooltip.position=this.tooltip.parent.toLocal({x:0,y:0}),this.tooltip.visible=!0,this.tooltip.set.previous=this.tooltip,setTimeout(function(){b.tooltip.visible=!1},2E3))};
TooltipSet.hideTooltip=function(a){this.tooltip.visible=!1};
function createOverlay(){var a=new PIXI.Container;a.buttons=new PIXI.Container;a.buttons.name="Buttons";var b=new PIXI.NineSlicePlane(PIXI.Loader.shared.resources.sprites.textures["dummy-texture.png"],0,0,0,0);a.tooltipSet=new TooltipSet;a.addChild(a.tooltipSet);a.tooltipSet.visible=!0;a.buttons.tooltips=new brcButton("?",void 0,{x:1,y:0},void 0,b,b);a.buttons.tooltips.face=new PIXI.Sprite(PIXI.Loader.shared.resources.sprites.textures["question.png"]);a.buttons.tooltips.isToggle=!0;a.buttons.tooltips.onOff=
!1;a.buttons.tooltips.onToggle=function(a){controller.tooltipSet.visible=a};a.buttons.addChild(a.buttons.tooltips);b="";onMobile?(b="hey there you!",iOS&&(b+="\n"),b+="\nbefore you go on ahead, you should really go into fullscreen, it's just nicer don't you think? also, if you're feeling lost, tap the \"?\" icon above.",b=iOS?b+"\n\nhave fun!":b+"\nhave fun!\n\ngo fullscreen?"):(b="... but it seems your browser doesn't support it :(. ",haveMidi&&(b=", it connects automatically when you plug it in! "),
b="hi there! \nbefore you go on ahead, you should know you can also control this synth with a midi controller"+b+'also, if you\'re feeling lost, click the "?" icon above to show tooltips. \nhave fun! ');a.windows=new PIXI.Container;a.windows.fullscreen=new brcWindow({x:controller.texture.width,y:controller.texture.height+10});a.windows.fullscreen.text=new PIXI.BitmapText(b,{align:"center",font:"8px pixelmix"});a.windows.fullscreen.pivot.set(a.windows.fullscreen.width/2,a.windows.fullscreen.height/
2);a.windows.fullscreen.text.anchor.set(.5,0);a.windows.fullscreen.text.position.set(a.windows.fullscreen.width/2,10);a.windows.fullscreen.text.maxWidth=220;a.windows.fullscreen.addChild(a.windows.fullscreen.text);a.windows.fullscreen.name="Fullscreen request";a.windows.fullscreen.visible=!0;a.windows.fullscreen.xButton.visible=!1;iOS||a.windows.addChild(a.windows.fullscreen);a.windows.fullscreen.buttonNah=new brcButton("nah...",{x:60,y:18},{x:1,y:1});a.windows.fullscreen.buttonYeah=new brcButton("yeah!",
{x:60,y:18},{x:0,y:1});a.windows.fullscreen.buttonNah.position.set(a.windows.fullscreen.width/2-3,a.windows.fullscreen.height-6);a.windows.fullscreen.buttonYeah.position.set(a.windows.fullscreen.width/2+3,a.windows.fullscreen.height-6);a.windows.fullscreen.buttonNah.onClick=function(){audioEngine.start();a.windows.fullscreen.visible=!1};a.windows.fullscreen.buttonYeah.onClick=function(){audioEngine.start();var b=document.getElementById("pixicanvas");iOS||(b.requestFullScreen||b.webkitRequestFullScreen||
b.mozRequestFullScreen).call(b);a.windows.fullscreen.visible=!1};a.windows.fullscreen.buttonLetsgo=new brcButton("let's go!",{x:100,y:18},{x:.5,y:1});a.windows.fullscreen.buttonLetsgo.position.set(a.windows.fullscreen.width/2,a.windows.fullscreen.height-6);a.windows.fullscreen.buttonLetsgo.onClick=function(){audioEngine.start();a.windows.fullscreen.visible=!1};onMobile&&!iOS?(a.windows.fullscreen.addChild(a.windows.fullscreen.buttonNah),a.windows.fullscreen.addChild(a.windows.fullscreen.buttonYeah)):
a.windows.fullscreen.addChild(a.windows.fullscreen.buttonLetsgo);a.addChild(a.windows);a.addChild(a.buttons);return a}
var noteRange=[48,72],currentOctave=4,Controller=function(a,b){var c=PIXI.Loader.shared.resources.sprites.spritesheet;var d=PIXI.Sprite.call(this,c.textures["base.png"])||this;d.spritesheet=c;d._noteStack=[];d.tooltipSet=new TooltipSet;d.tooltipSet.visible=!1;d.addChild(function(a){for(var b=[],c,d=0;30>d;d++)c=d,10>d&&(c="0"+c),b.push(a.spritesheet.textures[c+".png"]);a=new PIXI.AnimatedSprite(b);a.animationSpeed=.5;a.x=192;a.y=22;a.play();a.name="Sine Animation";return a}(d));d.addChild(function(a){var b=
[110,118,126,134,142,150,158,166,174,182],c=[0,9,2,9,1,6,1,3,8,7],d="detune B;lowpass filter;highpass filter;LFO frequency;LFO amplitude;delay time;delay feedback;reverb resonance;reverb dampening;reverb wet/dry".split(";"),g=[function(a){audioEngine.oscillatorB.shift=a},function(a){audioEngine.lowpass.frequency=a},function(a){audioEngine.highpass.frequency=a},function(a){audioEngine.lfo.frequency=a},function(a){audioEngine.lfo.gain=a/10},function(a){audioEngine.delay.time=a/20},function(a){audioEngine.delay.feedback=
a/10},function(a){audioEngine.reverb.resonance=a},function(a){audioEngine.reverb.dampening=a},function(a){audioEngine.reverb.wet=a/10}],f=new PIXI.Container;f.name="Sliders";for(var h=0;h<b.length;h++){var p=new brcSlider(b[h],c[h],d[h],a.create(d[h],"right"),g[h]);f.addChild(p)}return f}(d.tooltipSet));d.addChild(function(a){var b=[],d=c.textures["straight-knob.png"],h=c.textures["diagonal-knob.png"];b.push(d);b.push(h);for(var g=6;0<g;g-=2){var f=new PIXI.Texture(d,d.frame,d.orig,void 0,g),m=new PIXI.Texture(h,
h.frame,h.orig,void 0,g);b.push(f);b.push(m)}d=[0,15,30,45,60,75,5,20,35,50,65,80];h=[0,0,0,0,0,0,13,13,13,13,13,13];g="attack A;sustain A;decay A;release A;gain A;gain B;shape A;shape B;attack B;sustain B;decay B;release B".split(";");f=[2,7,4,3,7,3,1,3,1,1,5,4];m=[8,8,8,8,8,8,4,4,8,8,8,8];var p=[function(a){audioEngine.envelopeA.attack=a},function(a){audioEngine.envelopeA.sustain=remap(a,[0,7],[0,.5])},function(a){audioEngine.envelopeA.decay=remap(a,[0,7],[0,1])},function(a){audioEngine.envelopeA.release=
a},function(a){audioEngine.oscillatorA.gain=remap(a,[0,7],[0,1])},function(a){audioEngine.oscillatorB.gain=remap(a,[0,7],[0,1])},function(a){audioEngine.oscillatorB.shape=a},function(a){audioEngine.oscillatorA.shape=a},function(a){audioEngine.envelopeB.attack=a},function(a){audioEngine.envelopeB.sustain=remap(a,[0,7],[0,.5])},function(a){audioEngine.envelopeB.decay=remap(a,[0,7],[0,1])},function(a){audioEngine.envelopeB.release=a}],q=new PIXI.Container;q.name="Knobs";for(var n=0;12>n;n++){var r=new brcKnob(b,
d[n]+12,h[n]+27,g[n],a.create(g[n],"left"),f[n],m[n],p[n]);q.addChild(r)}return q}(d.tooltipSet));d.addChild(function(a){var b=new PIXI.Container;b.name="Octave Buttons";var c=new brcOctaveButton("down",5,95,a,a.tooltipSet.create("octave-"));a=new brcOctaveButton("up",18,95,a,a.tooltipSet.create("octave+"));a.other=c;c.other=a;b.addChild(a);b.addChild(c);return b}(d));d.addChild(function(a){var b=new PIXI.Container("wheels");b.name="Wheels";var c=new brcWheel(5,55,1,"pitchwheel",a.tooltipSet.create("pitch wheel"),
function(a){audioEngine.oscillatorA.detune=200*(1-a);audioEngine.oscillatorB.detune=200*(1-a)});c.resetOnEnd=!0;var d=new brcWheel(18,55,1,"modwheel",a.tooltipSet.create("modulation wheel"),function(a){audioEngine.mod.pan(1-a)});b.addChild(d);b.mod=d;b.addChild(c);b.pitch=c;return a.wheels=b}(d));d.addChild(function(a){var b=new brcKeyboard([["a","A"],["w","W"],["s","S"],["e","E"],["d","D"],["f","F"],["t","T"],["g","G"],["y","Y"],["h","H"],["u","U"],["j","J"],["k","K"],["o"],["l"],["p"],[";"],[],
[],[],[],[],[],[],[]],a);b.position.set(35,54);return a.keyboard=b}(d));d.addChild(d.tooltipSet);d.pivot.x=Math.floor(a*d.width);d.pivot.y=Math.floor(b*d.height);return d};$jscomp.inherits(Controller,PIXI.Sprite);Controller.prototype.press=function(a){(0<this._noteStack.length&&this._noteStack.last().pitch!=a.pitch||0==this._noteStack.length)&&this._noteStack.push(a);audioEngine.play(a);a.pitch>=noteRange[0]&&a.pitch<=noteRange[1]&&this.keyboard.keyActive(a.pitch-noteRange[0],!0)};
Controller.prototype.release=function(a){for(var b=-1,c=0;c<this._noteStack.length;c++)if(this._noteStack[c].pitch==a.pitch){b=c;break}-1!=b&&this._noteStack.removeFrom(b);0==this._noteStack.length?audioEngine.release():this.press(this._noteStack.last());a.pitch>=noteRange[0]&&a.pitch<=noteRange[1]&&this.keyboard.keyActive(a.pitch-noteRange[0],!1)};
Controller.prototype.shiftStack=function(a){if(0!=this._noteStack.length){for(var b=$jscomp.makeIterator(this._noteStack),c=b.next();!c.done;c=b.next())if(c=c.value,!c.midi){var d=c.pitch-noteRange[0];this.keyboard.keyActive(d,!1);c.pitch+=12*a;d=c.pitch-noteRange[0];this.keyboard.keyActive(d,!0)}a=this._noteStack.last();audioEngine.play(a)}};
Controller.processMIDIMessage=function(a){var b=a.data[1],c=2<a.data.length?a.data[2]:0;switch(a.data[0]){case 144:0<c?controller.press({pitch:b,velocity:c,midi:!0}):controller.release({pitch:b});break;case 128:controller.release({pitch:b});break;case 176:controller.wheels.mod.value=a.data[2]/64;break;case 224:controller.wheels.pitch.value=(1-a.data[2])/64}};
var brcKeyboard=function(a,b){function c(a){var b=a.data;b.dragging=!0;var c=renderer.plugins.interaction.hitTest(b.global,this);b.currentKey=c;this.press(c.keyId,b.getLocalPosition(c).y);this.inputs[a.data.identifier]=b}function d(a){null!=this.inputs[a.data.identifier]&&this.inputs[a.data.identifier].dragging&&(this.release(this.inputs[a.data.identifier].currentKey.keyId),this.inputs[a.data.identifier]=null)}function h(a){if(this.inputs[a.data.identifier]&&null!=this.inputs[a.data.identifier]){var b=
renderer.plugins.interaction.hitTest(this.inputs[a.data.identifier].global,this);null==b?(this.release(this.inputs[a.data.identifier].currentKey.keyId),this.inputs[a.data.identifier]=null):b.keyId!=this.inputs[a.data.identifier].currentKey.keyId&&(this.press(b.keyId,this.inputs[a.data.identifier].getLocalPosition(b).y),this.release(this.inputs[a.data.identifier].currentKey.keyId),this.inputs[a.data.identifier].currentKey=b)}}var e=PIXI.Container.call(this)||this;e.controller=b;var k=[9,4,9,4,13,9,
4,9,4,9,4,13],l=[0,1,0,1,0,0,1,0,1,0,1,0];e.keys=[];e.map={};e.buttons={};for(var g=0,f=0;25>f;f++){var m=new brcKey(g,0,f,e);m.zIndex=l[f%12];for(var p={pressed:!1},q=0;q<a[f].length;q++)e.buttons[a[f][q]]=p,e.map[a[f][q]]=m;e.keys.push(m);e.addChild(m);g+=k[f%12]}e.sortChildren();e.downHandler=function(a){(";"!=a.key||1!=a.getModifierState("CapsLock"))&&a.key in e.buttons&&!e.buttons[a.key].pressed&&(e.press(e.map[a.key].keyId),e.buttons[a.key].pressed=!0,a.preventDefault())};e.upHandler=function(a){(";"!=
a.key||1!=a.getModifierState("CapsLock"))&&a.key in e.buttons&&e.buttons[a.key].pressed&&(e.release(e.map[a.key].keyId),e.buttons[a.key].pressed=!1,a.preventDefault())};a=e.downHandler.bind(e);k=e.upHandler.bind(e);window.addEventListener("keydown",a,!1);window.addEventListener("keyup",k,!1);e.caps=keybind("CapsLock");e.caps.isOn=!1;e.caps.press=function(){e.caps.isOn=!e.caps.isOn;var a=e.caps.isOn?1:-1;e.shift.isDown||b.shiftStack(a)};e.shift=keybind("Shift");e.shift.press=function(){e.caps.isOn||
b.shiftStack(1)};e.shift.release=function(){e.caps.isOn||b.shiftStack(-1)};e.inputs=[];e.interactive=!0;e.buttonMode=!0;e.interactiveChildren=!0;e.dragging=!1;e.on("mousedown",c).on("touchstart",c).on("mouseup",d).on("mouseupoutside",d).on("touchend",d).on("touchendoutside",d).on("touchmove",h).on("mousemove",h);return e};$jscomp.inherits(brcKeyboard,PIXI.Container);brcKeyboard.prototype.release=function(a){a+=noteRange[0];if(this.shift.isDown||this.caps.isOn)a+=12;this.controller.release({pitch:a})};
brcKeyboard.prototype.press=function(a,b){var c=this.keys[a];b=b||3*c.height/4;a=c.keyId+noteRange[0];if(this.shift.isDown||this.caps.isOn)a+=12;b=Math.floor(remap(b,[0,c.height],[0,127]));this.controller.press({pitch:a,velocity:b})};brcKeyboard.prototype.keyActive=function(a,b){var c=this.keys[a];null!=c&&(c.texture=controller.spritesheet.textures[KEY_TYPES[a]+(b?"-on.png":".png")])};
var brcComponent=function(a,b,c,d,h,e,k,l,g,f){a=PIXI.Sprite.call(this,a)||this;a.x=b;a.y=c;a.pivot.x=d;a.pivot.y=h;a.callbackFunc=f;a.name=e;a.maxValue=k;a.value=l;if(g)if(a.tooltip=g,onMobile)a.on("touchstart",TooltipSet.showTooltipOnTap);else a.on("mouseover",TooltipSet.showTooltipOnHover).on("mouseout",TooltipSet.hideTooltip);return a};$jscomp.inherits(brcComponent,PIXI.Sprite);
$jscomp.global.Object.defineProperties(brcComponent.prototype,{value:{configurable:!0,enumerable:!0,set:function(a){this._value=a;this.callbackFunc(a)},get:function(){return this._value}}});var brcKey=function(a,b,c,d){a=brcComponent.call(this,PIXI.Loader.shared.resources.sprites.spritesheet.textures[KEY_TYPES[c]+".png"],a,b,0,0,"key"+c,0,0,void 0,function(){})||this;a.keyId=c;a.interactive=!0;return a};$jscomp.inherits(brcKey,brcComponent);
var brcOctaveButton=function(a,b,c,d,h){function e(){7!=currentOctave&&(currentOctave++,noteRange[0]+=12,noteRange[1]+=12,this.controller.shiftStack(1),this.updateTexture(),this.other.updateTexture())}function k(){1!=currentOctave&&(currentOctave--,noteRange[0]-=12,noteRange[1]-=12,this.controller.shiftStack(-1),this.updateTexture(),this.other.updateTexture())}var l=PIXI.Loader.shared.resources.sprites.spritesheet.textures;var g=brcComponent.call(this,l["button-"+a+".png"],b,c,0,0,"octave"+a,0,0,
h,function(){})||this;g.type=a;g.controller=d;g.textures=l;g.callbackFunc="up"==a?e:k;g.interactive=!0;g.buttonMode=!0;g.on("mousedown",g.callbackFunc).on("touchstart",g.callbackFunc);a="up"==a?"x":"z";g.keyButtonL=keybind(a);g.keyButtonL.press=function(){g.callbackFunc()};g.keyButtonU=keybind(a.toUpperCase());g.keyButtonU.press=function(){g.callbackFunc()};return g};$jscomp.inherits(brcOctaveButton,brcComponent);
brcOctaveButton.prototype.updateTexture=function(){var a=-1,b=0;"down"==this.type?(a=4-currentOctave,b=4):"up"==this.type&&(a=currentOctave-4);0<=a&&(this.texture=this.textures[BUTTON_TYPE[a+b]])};
var brcSlider=function(a,b,c,d,h){function e(a){this.eventData=a.data;this.dragging=!0}function k(a){this.eventData=null;this.dragging=!1}function l(a){this.dragging&&(a=this.eventData.getLocalPosition(this.parent),a.y>SLIDER_RANGE[0]&&a.y<=SLIDER_RANGE[1]&&(a=round(a.y,2)+1,this.value=(SLIDER_RANGE[1]-a)/2,this.position.y=a))}a=brcComponent.call(this,PIXI.Loader.shared.resources.sprites.spritesheet.textures["slider.png"],a,SLIDER_RANGE[1]-2*b,3,3,c,10,b,d,h)||this;a.on("mousedown",e).on("touchstart",
e).on("mouseup",k).on("touchend",k).on("mousemove",l).on("touchmove",l).on("mouseupoutside",k).on("touchendoutside",k);a.buttonMode=!0;a.interactive=!0;return a};$jscomp.inherits(brcSlider,brcComponent);$jscomp.global.Object.defineProperties(brcSlider.prototype,{value:{configurable:!0,enumerable:!0,set:function(a){0<=a&&a<=this.maxValue&&(this._value=a,this.callbackFunc(a))},get:function(){return this._value}}});
var brcKnob=function(a,b,c,d,h,e,k,l){function g(a){this.value++}function f(a){this.eventData=a.data;this.eventData.startingValue=this.value;this.dragging=!0}function m(a){this.eventData=null;this.dragging=!1}function p(a){this.dragging&&(a=this.eventData.getLocalPosition(this),a=-round(a.y,8)/8,0==a&&this.value++,a=this.eventData.startingValue+a,a=Math.max(0,a),this.value=a=Math.min(a,7))}if(4==k||8==k)return b=brcComponent.call(this,4==k?a[2*e]:a[e],b,c,4,4,d,k-1,e,h,l)||this,b._type=k,b.textures=
a,b.value=e,b.on("click",g).on("tap",g).on("mousedown",f).on("touchstart",f).on("mouseup",m).on("touchend",m).on("mousemove",p).on("touchmove",p).on("mouseupoutside",m).on("touchendoutside",m),b.buttonMode=!0,b.interactive=!0,b};$jscomp.inherits(brcKnob,brcComponent);brcKnob.matchTexture=function(a,b,c){if(void 0!=c)return 4==b&&(a*=2),c[a]};
$jscomp.global.Object.defineProperties(brcKnob.prototype,{value:{configurable:!0,enumerable:!0,set:function(a){this._value=a%=this.maxValue+1;this.texture=brcKnob.matchTexture(a,this._type,this.textures);this.callbackFunc(this._value)},get:function(){return this._value}}});
var brcWheel=function(a,b,c,d,h,e){function k(a){this.eventData=a.data;this.dragging=!0;this.value=this.valueFrom(this.eventData.getLocalPosition(this))}function l(a){this.eventData=void 0;this.dragging=!1;this.resetOnEnd&&(this.value=1)}function g(a){this.dragging&&(a=this.eventData.getLocalPosition(this),this.value=this.valueFrom(a))}a=brcComponent.call(this,PIXI.Loader.shared.resources.sprites.spritesheet.textures["touch-wheel.png"],a,b,0,0,d,2,c,h,e)||this;a.yRange=[2,36];a.on("mousedown",k).on("touchstart",
k).on("mouseup",l).on("mouseupoutside",l).on("touchend",l).on("touchendoutside",l).on("mousemove",g).on("touchmove",g);a.buttonMode=!0;a.interactive=!0;a.resetOnEnd=!1;return a};$jscomp.inherits(brcWheel,brcComponent);brcWheel.prototype.valueFrom=function(a){a=Math.floor(a.y);a<this.yRange[0]?a=this.yRange[0]:a>this.yRange[1]&&(a=this.yRange[1]);return remap(a,this.yRange,[0,2])};
var SHIFT_CURVE=[-1200,-1100,-700,-400,-300,0,300,400,700,1100,1200],LOWPASS_CURVE=[150,400,700,1200,3E3,3500,4E3,5E3,6E3,7E3,1E4],HIGHPASS_CURVE=[50,150,250,450,650,800,1E3,1200,1500,2E3,3E3],DAMPENING_CURVE=[100,300,600,1E3,2E3,4E3,6500,8E3,1E4,14E3,19E3],RELEASE_CURVE=[0,.1,.2,.3,.6,1,1.5,2.5],ATTACK_CURVE=[0,.02,.05,.1,.3,.5,.8,1.2],COMB_FILTER_TUNINGS=[1557,1617,1491,1422,1277,1356,1188,1116].map(function(a){return a/44100}),ALLPASS_FREQUENCES=[225,556,441,341],DEFAULT_VOLUME=.8,AudioEngine=
function(){var a=window.AudioContext||window.webkitAudioContext;this.started=!1;this.audioContext=new a;this._noteOn=!1;this.resetEnvelope=this.velocity=!0;this.slideSpeed=.1;this._gainM=this.audioContext.createGain();this.oscillatorA=new Oscillator(this.audioContext);this.oscillatorB=new Oscillator(this.audioContext);this.envelopeA=new Envelope(this.audioContext);this.envelopeB=new Envelope(this.audioContext);this.lowpass=new Filter(this.audioContext,"lowpass");this.highpass=new Filter(this.audioContext,
"highpass");this.lfo=new LFO(this.audioContext);this.mod=new GainPan(this.audioContext);this.delay=new Delay(this.audioContext);this.reverb=new Freeverb(this.audioContext);this.oscillatorA.node.connect(this.mod.left);this.mod.left.connect(this.envelopeA.node);this.envelopeA.node.connect(this.lowpass.node);this.oscillatorB.node.connect(this.mod.right);this.mod.right.connect(this.envelopeB.node);this.envelopeB.node.connect(this.lowpass.node);this.lowpass.node.connect(this.highpass.node);this.highpass.node.connect(this.lfo.node);
this.lfo.node.connect(this.delay.input);this.delay.output.connect(this.reverb.input);this.reverb.output.connect(this._gainM);this._gainM.connect(this.audioContext.destination);iOS&&this.start()};AudioEngine.prototype.start=function(){this.started?console.log("AUDIOENGINE STARTED TWICE!"):(this.started=!0,"suspended"===this.audioContext.state&&this.audioContext.resume(),this._gainM.gain.value=1,this.lfo.start(0),this.oscillatorA.start(0),this.oscillatorB.start(0))};
AudioEngine.prototype.play=function(a){"suspended"===this.audioContext.state&&this.audioContext.resume();var b=remap(a.velocity,[0,127],[0,1]);a=a.pitch;this._noteOn?(this.resetEnvelope&&(this.envelopeA.reset(0),this.envelopeB.reset(0),this.envelopeA.start(0),this.envelopeB.start(0)),this.oscillatorA.slideTo(frequency(a),this.slideSpeed),this.oscillatorB.slideTo(frequency(a),this.slideSpeed)):(this.envelopeA.reset(0),this.envelopeB.reset(0),0==this.velocity&&(b=DEFAULT_VOLUME),this.oscillatorA.frequency=
frequency(a),this.oscillatorB.frequency=frequency(a),this._gainM.gain.setTargetAtTime(b,this.audioContext.currentTime,.001),this.envelopeA.start(0),this.envelopeB.start(0),this._noteOn=!0)};AudioEngine.prototype.release=function(){"suspended"===this.audioContext.state&&this.audioContext.resume();this.envelopeA.stop(0);this.envelopeB.stop(0);this._noteOn=!1};var Oscillator=function(a){this._detune=this._shift=0;this.audioContext=a;this._oscillator=a.createOscillator();this.node=a.createGain();this._oscillator.connect(this.node)};
Oscillator.prototype.slideTo=function(a,b){b=b||3E-4;this._oscillator.frequency.setTargetAtTime(a,this.audioContext.currentTime+b,.3*b)};Oscillator.prototype.start=function(a){this._oscillator.start(a)};Oscillator.prototype.stop=function(a){this._oscillator.stop(a)};
$jscomp.global.Object.defineProperties(Oscillator.prototype,{shape:{configurable:!0,enumerable:!0,set:function(a){switch(a){case 0:a="sine";break;case 1:a="square";break;case 2:a="sawtooth";break;case 3:a="triangle";break;default:a="sine"}this._oscillator.type=a}},frequency:{configurable:!0,enumerable:!0,get:function(){return this._oscillator.frequency.value},set:function(a){this._oscillator.frequency.setTargetAtTime(a,this.audioContext.currentTime,.001)}},gain:{configurable:!0,enumerable:!0,get:function(){return this.node.gain.value},
set:function(a){this.node.gain.setTargetAtTime(a,this.audioContext.currentTime,.001)}},shift:{configurable:!0,enumerable:!0,get:function(){return this._shift},set:function(a){this._shift=SHIFT_CURVE[a];this._oscillator.detune.setTargetAtTime(this._shift+this._detune,this.audioContext.currentTime,.001)}},detune:{configurable:!0,enumerable:!0,get:function(){return this._detune},set:function(a){this._detune=a;this._oscillator.detune.setTargetAtTime(this._shift+this._detune,this.audioContext.currentTime,
.001)}}});
var Freeverb=function(a){var b=this;this.audioContext=a;this.input=a.createGain();this.output=a.createGain();this._dry=a.createGain();this._wet=a.createGain();this._merger=a.createChannelMerger(2);this._doubler={};this._doubler.left=a.createGain();this._doubler.right=a.createGain();this._wet.gain.value=.6;this._dry.gain.value=.4;this.input.connect(this._wet);this._wet.connect(this._doubler.left);this._wet.connect(this._doubler.right);this.input.connect(this._dry);this._dry.connect(this.output);this._combFilters=
COMB_FILTER_TUNINGS.map(function(b){return new CombFilter(a,b)});var c=this._combFilters.slice(0,4),d=this._combFilters.slice(4);this._allPassFilters=[];for(var h=$jscomp.makeIterator(ALLPASS_FREQUENCES),e=h.next();!e.done;e=h.next()){e=e.value;var k=a.createBiquadFilter();k.type="allpass";k.frequency.value=e;this._allPassFilters.push(k)}c.forEach(function(a){b._doubler.left.connect(a.input);a.output.connect(b._merger,0,0)});d.forEach(function(a){b._doubler.right.connect(a.input);a.output.connect(b._merger,
0,1)});this._merger.connect(this._allPassFilters[0]);this._allPassFilters[0].connect(this._allPassFilters[1]);this._allPassFilters[1].connect(this._allPassFilters[2]);this._allPassFilters[2].connect(this._allPassFilters[3]);this._allPassFilters[3].connect(this.output)};
$jscomp.global.Object.defineProperties(Freeverb.prototype,{wet:{configurable:!0,enumerable:!0,get:function(){return this._wet.gain.value},set:function(a){this._wet.gain.setTargetAtTime(a,this.audioContext.currentTime,.001);this._dry.gain.setTargetAtTime((1-a)/2,this.audioContext.currentTime,.001)}},resonance:{configurable:!0,enumerable:!0,get:function(){return this._combFilters[0].resonance},set:function(a){for(var b=$jscomp.makeIterator(this._combFilters),c=b.next();!c.done;c=b.next())c.value.resonance=
a}},dampening:{configurable:!0,enumerable:!0,get:function(){return this._combFilters[0].dampening},set:function(a){for(var b=$jscomp.makeIterator(this._combFilters),c=b.next();!c.done;c=b.next())c.value.dampening=a}}});
var CombFilter=function(a,b){this.audioContext=a;this.input=a.createGain();this.output=a.createGain();this._lowPass=a.createBiquadFilter();this._delay=a.createDelay();this._gain=a.createGain();this._lowPass.type="lowpass";this._lowPass.frequency.value=440;this._delay.delayTime.value=b;this._gain.gain.value=.5;this.input.connect(this._delay);this._delay.connect(this._lowPass);this._lowPass.connect(this._gain);this._gain.connect(this._delay);this._gain.connect(this.output)};
$jscomp.global.Object.defineProperties(CombFilter.prototype,{resonance:{configurable:!0,enumerable:!0,get:function(){return this._gain.gain.value},set:function(a){a=remap(a,[0,10],[0,.75]);this._gain.gain.setTargetAtTime(a,this.audioContext.currentTime,.001)}},dampening:{configurable:!0,enumerable:!0,get:function(){return this._lowPass.frequency.value},set:function(a){a=DAMPENING_CURVE[a];this._lowPass.frequency.setTargetAtTime(a,this.audioContext.currentTime,.001)}}});
var LFO=function(a){Oscillator.call(this,a);this._oscillator.disconnect(this.node);this._constant=a.createConstantSource();this._gain=a.createGain();this._oscillator.connect(this._gain);this._constant.connect(this._gain);this._gain.connect(this.node.gain)};$jscomp.inherits(LFO,Oscillator);
$jscomp.global.Object.defineProperties(LFO.prototype,{frequency:{configurable:!0,enumerable:!0,get:function(){return this._oscillator.frequency.value},set:function(a){this._oscillator.frequency.setTargetAtTime(a*a/5,this.audioContext.currentTime,.001)}},gain:{configurable:!0,enumerable:!0,get:function(){return this._gain.value},set:function(a){this._gain.gain.setTargetAtTime(a,this.audioContext.currentTime,.001);this._constant.offset.setTargetAtTime((1-a)/2,this.audioContext.currentTime,.001)}}});
var Filter=function(a,b){this.audioContext=a;this.setValue=0;this.node=a.createBiquadFilter();this.node.type=b};
$jscomp.global.Object.defineProperties(Filter.prototype,{frequency:{configurable:!0,enumerable:!0,get:function(){return this.node.frequency.value},set:function(a){"lowpass"==this.node.type?a=LOWPASS_CURVE[a]:"highpass"==this.node.type&&(a=HIGHPASS_CURVE[a]);this.setValue=a;this.node.frequency.setTargetAtTime(a,this.audioContext.currentTime,.001)}},q:{configurable:!0,enumerable:!0,get:function(){return this.node.Q.value},set:function(a){a=remap(a,[0,10],[.25,5]);this.node.Q.setTargetAtTime(a,this.audioContext.currentTime,
.001)}}});var Envelope=function(a){this._open=!1;this.decay=this._release=this._attack=this._sustain=0;this.audioContext=a;this.node=a.createGain();this.node.gain.value=0};Envelope.prototype.start=function(a){this._open=!0;a+=this._attack;this.node.gain.linearRampToValueAtTime(.5,this.audioContext.currentTime+a);a+=this.decay;this.node.gain.linearRampToValueAtTime(this._sustain,this.audioContext.currentTime+a)};
Envelope.prototype.stop=function(a){this._open=!1;this.reset(0);this.node.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+(a+this._release))};Envelope.prototype.reset=function(a){this.node.gain.cancelScheduledValues(a)};
$jscomp.global.Object.defineProperties(Envelope.prototype,{sustain:{configurable:!0,enumerable:!0,get:function(){return this._sustain},set:function(a){this._sustain=a;this._open&&this.node.gain.setTargetAtTime(this._sustain,this.audioContext.currentTime,.001)}},attack:{configurable:!0,enumerable:!0,get:function(){return this._attack},set:function(a){this._attack=ATTACK_CURVE[a]}},release:{configurable:!0,enumerable:!0,get:function(){return this._release},set:function(a){this._release=RELEASE_CURVE[a]}}});
var Delay=function(a){this.audioContext=a;this.input=a.createGain();this._delay=a.createDelay();this._feedback=a.createGain();this.output=a.createGain();this.input.connect(this._feedback);this._delay.connect(this._feedback);this._feedback.connect(this._delay);this._delay.connect(this.output);this.input.connect(this.output)};
$jscomp.global.Object.defineProperties(Delay.prototype,{time:{configurable:!0,enumerable:!0,get:function(){return this._delay.delayTime.value},set:function(a){this._delay.delayTime.setTargetAtTime(a,this.audioContext.currentTime,.001)}},feedback:{configurable:!0,enumerable:!0,get:function(){return this._feedback.gain.value},set:function(a){this._feedback.gain.setTargetAtTime(a,this.audioContext.currentTime,.001)}}});var GainPan=function(a){this.audioContext=a;this.left=a.createGain();this.right=a.createGain()};
GainPan.prototype.pan=function(a){var b=1+a;this.left.gain.setTargetAtTime(1-a,this.audioContext.currentTime,.001);this.right.gain.setTargetAtTime(b,this.audioContext.currentTime,.001)};var DEBUG=!1,haveMidi=!1,scaleModifier=0,onMobile,iOS,audioEngine,controller,renderer,stage;
function main(){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST;PIXI.settings.ROUND_PIXELS=!0;renderer=new PIXI.Renderer({view:pixicanvas,backgroundColor:2584187});stage=new PIXI.Container;var a=PIXI.Ticker.shared,b=PIXI.Loader.shared;try{navigator.requestMIDIAccess().then(function(a){haveMidi=!0;for(var b=$jscomp.makeIterator(a.inputs.values()),c=b.next();!c.done;c=b.next())c.value.onmidimessage=Controller.processMIDIMessage;a.onstatechange=function(a){a.port.onmidimessage=Controller.processMIDIMessage}},
function(){console.log("MIDI Not Supported")})}catch(c){}onMobile=isMobile();iOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))!=iOS&&console.log("Confusion ensues! Two tests for iOS give two different results");b.add("tooltipFont","img/pixelmix.fnt").add("sprites","img/spritesheet.json").load(function(){function b(){vh=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",vh+"px");size={width:pixicanvas.clientWidth,
height:pixicanvas.clientHeight};pixicanvas.width=size.width*devicePixelRatio;pixicanvas.height=size.height*devicePixelRatio;renderer.resize(size.width,size.height);var a=size.width>size.height?"landscape":"portrait";if("landscape"==a){var b=Math.floor((size.width-5)/controller.texture.width);var c=Math.floor((size.height-5)/controller.texture.height)}else b=Math.floor((size.height-5)/controller.texture.width),c=Math.floor((size.width-5)/controller.texture.height);b=Math.min(b,c);b+=scaleModifier;
0==b&&alert("Where did you find a screen this small? Sorry, content won't fit!");controller.scale.set(b);d.scale.set(b);controller.position.set(renderer.screen.width/2,renderer.screen.height/2);d.position.set(renderer.screen.width/2,renderer.screen.height/2);"portrait"==a?(controller.angle=90,d.angle=90,d.buttons.position.set(renderer.screen.height/(2*b),-renderer.screen.width/(2*b)+2)):(controller.angle=0,d.angle=0,d.buttons.position.set(renderer.screen.width/(2*b),-renderer.screen.height/(2*b)+
2))}audioEngine=new AudioEngine;controller=new Controller(.5,.5);var d=createOverlay(),h=keybind("=");h.press=function(a){a.getModifierState("Control")&&(scaleModifier++,b())};h=keybind("-");h.press=function(a){a.getModifierState("Control")&&(scaleModifier--,b())};window.addEventListener("resize",b);b();stage.addChild(controller);stage.addChild(d);a.maxFPS=30;a.add(function(){renderer.render(stage)});a.start()})}